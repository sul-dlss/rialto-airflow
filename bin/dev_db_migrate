#!/bin/bash

# in a deployed environment, these would be set by puppet, using values from vault
export DATABASE_USERNAME=airflow # local dev/test container login
export DATABASE_PASSWORD=airflow
export DATABASE_HOSTNAME=localhost # using local container from outside it (i.e. from the container host)
export AIRFLOW_VAR_RIALTO_POSTGRES="postgresql+psycopg2://${DATABASE_USERNAME}:${DATABASE_PASSWORD}@${DATABASE_HOSTNAME}"

uv run python rialto_airflow/schema/bin/create_databases.py
uv run alembic upgrade head